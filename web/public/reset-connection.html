<!DOCTYPE html>
<html>
<head>
    <title>üîÑ Reset Connection</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; }
        .reset { background: #ef4444; color: white; border: none; border-radius: 5px; }
        .test { background: #10b981; color: white; border: none; border-radius: 5px; }
        .result { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .success { background: #d1fae5; border: 1px solid #10b981; }
        .error { background: #fee2e2; border: 1px solid #ef4444; }
    </style>
</head>
<body>
    <h1>üîÑ Connection Reset Tool</h1>
    <p>This will completely reset the wallet connection and clear all cached data.</p>
    
    <button class="reset" onclick="fullReset()">üßπ Full Reset</button>
    <button class="test" onclick="testConnection()">üß™ Test Connection</button>
    
    <div id="result"></div>

    <script>
        function showResult(message, isSuccess = true) {
            document.getElementById('result').innerHTML = 
                `<div class="result ${isSuccess ? 'success' : 'error'}">${message}</div>`;
        }

        function fullReset() {
            try {
                // Clear all localStorage
                localStorage.clear();
                
                // Clear sessionStorage
                sessionStorage.clear();
                
                // Force MetaMask to refresh
                if (window.ethereum) {
                    // Clear any cached accounts
                    window.ethereum.request({ method: 'eth_accounts' })
                        .then(() => {
                            showResult(`
                                ‚úÖ Reset Complete!<br>
                                ‚Ä¢ localStorage cleared<br>
                                ‚Ä¢ sessionStorage cleared<br>
                                ‚Ä¢ MetaMask cache refreshed<br><br>
                                <strong>Next steps:</strong><br>
                                1. Refresh the main page<br>
                                2. Reconnect MetaMask<br>
                                3. Make sure you're on Localhost 8545 network
                            `);
                        })
                        .catch(error => {
                            showResult(`‚ùå Reset with warning: ${error.message}`, false);
                        });
                } else {
                    showResult(`
                        ‚ö†Ô∏è Partial Reset Complete<br>
                        ‚Ä¢ localStorage cleared<br>
                        ‚Ä¢ sessionStorage cleared<br>
                        ‚Ä¢ MetaMask not detected<br><br>
                        Please refresh the main page.
                    `, false);
                }
            } catch (error) {
                showResult(`‚ùå Reset failed: ${error.message}`, false);
            }
        }

        async function testConnection() {
            try {
                if (!window.ethereum) {
                    showResult('‚ùå MetaMask not detected', false);
                    return;
                }

                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                
                showResult(`
                    üîç Connection Status:<br>
                    ‚Ä¢ Accounts: ${accounts.length > 0 ? accounts[0] : 'None'}<br>
                    ‚Ä¢ Chain ID: ${chainId}<br>
                    ‚Ä¢ Expected: 31337 (0x7a69)<br>
                    ‚Ä¢ Status: ${chainId === '0x7a69' ? '‚úÖ Correct network' : '‚ùå Wrong network'}
                `);
                
            } catch (error) {
                showResult(`‚ùå Test failed: ${error.message}`, false);
            }
        }

        // Auto-test on load
        window.onload = () => {
            setTimeout(testConnection, 1000);
        };
    </script>
</body>
</html>
